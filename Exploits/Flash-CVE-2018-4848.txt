// This query checks for specific processes and domain TLD used in the CVE-2018-4878 flash 0day exploit attack reported by KrCERT.
//
// CVE: CVE-2018-4878
// Read more here:
// https://www.krcert.or.kr/data/secNoticeView.do?bulletin_writing_sequence=26998
// https://helpx.adobe.com/security/products/flash-player/apsa18-01.html
// http://blog.talosintelligence.com/2018/02/group-123-goes-wild.html
// http://blog.morphisec.com/flash-exploit-cve-2018-4878-spotted-in-the-wild-massive-malspam-campaign
//
// Tags: #exploit #CVE-2018-4878 #0day #Korea #Flash

DeviceNetworkEvents 
| where Timestamp > ago(14d) 
| where InitiatingProcessFileName =~ "cmd.exe" and InitiatingProcessParentFileName =~ "excel.exe" 
| where RemoteUrl endswith ".kr" 
| project Timestamp, DeviceName, RemoteIP, RemoteUrl  
| top 100 by Timestamp
