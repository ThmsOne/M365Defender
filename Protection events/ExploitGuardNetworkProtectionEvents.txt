//Simple query to show the unique network connections that were audited or blocked by ExploitGuard
// For more questions on this query, feel free to ping @FlyingBlueMonki on twitter or mattegen@microsoft.com via email
DeviceEvents
| where Timestamp > ago(7d)
| where  ActionType  =~ "ExploitGuardNetworkProtectionBlocked"
| summarize count(RemoteUrl) by InitiatingProcessFileName, RemoteUrl, Audit_Only=tostring(parse_json(AdditionalFields).IsAudit)
| sort by count_RemoteUrl desc